<?php echo $this->render('header.phtml'); ?>

<?php echo $this->standardPage('Minder.Orders.ImportMapped.AutoGenerated', true);?>

<div id="UPLOAD-FILE-DLG" class="flora hidden" title="Upload File">
    <?php
    echo $this->form;
    ?>
</div>

<script type="text/javascript">

    minderNamespace('Minder.Orders.ImportMapped', function(){
        $.extend(this, Minder.Orders.ImportMapped.AutoGenerated);

        this.load = function() {
            Minder.Orders.ImportMapped.AutoGenerated.onLoad.call(this);
            this.getDialogContainer().dialog({
                buttons: {
                    CANCEL: function(evt){
                        evt.preventDefault();
                        Minder.Orders.ImportMapped.closeImportDialog();
                    }
                },
                buttonStyle: 'green-button',
                insertHtml:  '&nbsp;',
                autoOpen  : false,
                width     : 400,
                height    : 260,
                resizable : false,
                modal     : false
            }).unbind('dialogopen').bind('dialogopen', function(event, ui) {
                $(this).show();
            }).unbind('dialogclose').bind('dialogclose', function(event, ui) {
            });
        };

        this.importSelected = function(pathField, sysScreenName) {
            var data = this.prepareLoadDataToSend(this.getRegisteredNamespaces());
            data.pathField = pathField;
            data.screenName = sysScreenName;

            $.post(
                '<?php echo $this->url(array('action' => 'import-selected'));?>',
                data,
                $.proxy(this.onDataReady, this),
                'json'
            );
        };

        this.showImportDialog = function() {
            this.getDialogContainer().dialog('open');
        };

        this.closeImportDialog = function() {
            this.getDialogContainer().dialog('close');
        };

        this.getDialogContainer = function() {
            return $('#UPLOAD-FILE-DLG');
        }
    });

    $(function(){
        Minder.Orders.ImportMapped.load();
    });

    function importSelected(pathField, sysScreenName) {
        Minder.Orders.ImportMapped.importSelected(pathField, sysScreenName);
    }

    function uploadFile() {
        Minder.Orders.ImportMapped.showImportDialog();
    }
</script>


<?php echo $this->StandardSRTemplate(array(), true); ?>

<?php echo $this->render('footer.phtml'); ?>
